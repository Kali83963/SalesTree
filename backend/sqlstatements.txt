// To Create Company Table
CREATE TABLE company (
    ID serial PRIMARY KEY,
    name varchar(30) UNIQUE NOT NULL ,
    created_at timestamp default current_timestamp,
    updated_at timestamp default current_timestamp,
    is_delete boolean default false
);

// To Create User Table

CREATE TABLE users (
    ID serial PRIMARY KEY,
    name varchar(255) NOT NULL,
    profile_image varchar(255),
    email varchar(255) UNIQUE NOT NULL,
    company_id integer NOT NULL,
    password varchar(255) NOT NULL,
    address TEXT, -- Changed type to TEXT
    currency varchar(10),
    timezone varchar(50),
    created_at timestamp default current_timestamp,
    updated_at timestamp default current_timestamp,
    is_delete boolean default false,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE
);

// Grant Access to Table
    GRANT ALL PRIVILEGES ON TABLE users TO admin;

CREATE TABLE employees (
    ID serial PRIMARY KEY,
    user_id INT,
    created_by INT,
    role varchar(20) CHECK (role IN ('admin', 'sales associate')) NOT NULL default 'sales associate',
    status varchar(20) CHECK (status IN ('active','inactive')) NOT NULL default 'active',
    created_at timestamp default current_timestamp,
    updated_at timestamp default current_timestamp,
    is_delete boolean default false,
    FOREIGN KEY (user_id) REFERENCES users (ID) ON DELETE CASCADE,
    FOREIGN KEY (created_by) REFERENCES users (ID) ON DELETE CASCADE
);

CREATE TABLE category (
    ID serial PRIMARY KEY,
    name varchar(255) NOT NULL,
    description TEXT NOT NULL,
    company_id integer NOT NULL,
    created_user INT NOT NULL,
    created_at timestamp default current_timestamp,
    updated_at timestamp default current_timestamp,
    is_delete boolean default false,
    FOREIGN KEY (created_user) REFERENCES users (ID) ON DELETE CASCADE,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE
);



CREATE TABLE sub_category (
    ID serial PRIMARY KEY,
    name varchar(255) NOT NULL,
    description TEXT NOT NULL,
    created_user INT NOT NULL, -- Enclosed user in double quotes
    company_id INT NOT NULL,
    category INT NOT NULL,
    FOREIGN KEY (created_user) REFERENCES users (ID) ON DELETE CASCADE, -- Enclosed user in double quotes
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE,
    FOREIGN KEY (category) REFERENCES category (ID) ON DELETE CASCADE,
    created_at timestamp default current_timestamp,
    updated_at timestamp default current_timestamp,
    is_delete boolean default false
);

CREATE TABLE manufacture(
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    company_id INT NOT NULL,
    created_user INT NOT NULL,
    FOREIGN KEY (created_user) REFERENCES users (ID) ON DELETE CASCADE,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_delete BOOLEAN DEFAULT FALSE,
    image VARCHAR(255)
);

CREATE TABLE product (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    company_id INTEGER NOT NULL,
    category_id INTEGER NOT NULL,
    manufacture_id INTEGER NOT NULL,
    sku VARCHAR(100) NOT NULL,
    unit VARCHAR(100) NOT NULL,
    selling_price DECIMAL(20,2) NOT NULL,
    barcode VARCHAR(100) NOT NULL,
    image VARCHAR(255) NOT NULL,
    sub_category_id INTEGER NOT NULL,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES category (ID) ON DELETE CASCADE,
    FOREIGN KEY (manufacture_id) REFERENCES manufacture (ID) ON DELETE CASCADE,
    FOREIGN KEY (sub_category_id) REFERENCES sub_category (ID) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_delete BOOLEAN DEFAULT FALSE,
);


CREATE TABLE sales (
    id SERIAL PRIMARY KEY,
    customer_name VARCHAR(255) NOT NULL,
    created_user INT NOT NULL,
    total_cost INT NOT NULL,
    company_id INTEGER NOT NULL,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE,
    FOREIGN KEY (created_user) REFERENCES users (ID) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_delete BOOLEAN DEFAULT FALSE,
    customer_phoneno VARCHAR(255) NOT NULL,
    cash_received INT NOT NULL,
    discount INT NOT NULL,
    cash_refund INT NOT NULL,
    payment_method VARCHAR(255) NOT NULL
);

CREATE TABLE sales_item (
    id SERIAL PRIMARY KEY,
    sales_id INT NOT NULL,
    product_id INT NOT NULL,
    created_user INT NOT NULL,
    company_id INTEGER NOT NULL,
    FOREIGN KEY (company_id) REFERENCES company (ID) ON DELETE CASCADE,
    cost INT NOT NULL,
    quantity INT NOT NULL,
    FOREIGN KEY (created_user) REFERENCES users (ID) ON DELETE CASCADE,
    FOREIGN KEY (sales_id) REFERENCES sales (ID) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES product (ID) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_delete BOOLEAN DEFAULT FALSE
);
GRANT USAGE, SELECT ON SEQUENCE sales_id_seq TO salestree;
